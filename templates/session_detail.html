{% extends "base.html" %}
{% block content %}
<section class="space-y-4">
  <div class="flex items-start justify-between">
    <div>
      <h2 class="text-2xl font-semibold">Sesión del {{ session.started_at.strftime('%d/%m/%Y %H:%M') }}</h2>
      <p class="text-sm text-slate-300 mt-1">{{ session.duration_min }} min · {{ session.instrument.name }}</p>
    </div>
    <a href="{{ url_for('sessions_list') }}" class="text-sm text-emerald-300">← Volver al historial</a>
  </div>

  {% if session.description %}
    <p class="bg-slate-800/60 border border-slate-700 rounded p-4">{{ session.description }}</p>
  {% endif %}

  <section class="space-y-3">
    <h3 class="text-lg font-semibold">Temas trabajados</h3>
    <ul class="space-y-3" id="session-topics">
      {% for session_topic in session.topics %}
        {% include "_session_topic.html" %}
      {% else %}
        <li class="text-slate-400">Aún no se han registrado temas.</li>
      {% endfor %}
    </ul>
  </section>

  <section class="border border-slate-700 rounded p-4 bg-slate-800/40 space-y-3">
    <h3 class="text-lg font-semibold">Añadir tema</h3>
    <form hx-post="{{ url_for('add_topic_to_session', session_id=session.id) }}" hx-target="#session-topics" hx-swap="afterbegin" class="space-y-3">
      <div>
        <label class="text-xs text-slate-400 uppercase">Tema</label>
        <input type="text" name="name" list="topic-options" required class="mt-1 w-full bg-slate-900/60 border-slate-700 rounded" />
      </div>
      <div>
        <label class="text-xs text-slate-400 uppercase">Notas</label>
        <textarea name="note" rows="2" class="mt-1 w-full bg-slate-900/60 border-slate-700 rounded"></textarea>
      </div>
      <div>
        <label class="text-xs text-slate-400 uppercase">Etiquetas (separadas por comas)</label>
        <input type="text" name="tags" list="tag-options" class="mt-1 w-full bg-slate-900/60 border-slate-700 rounded" />
      </div>
      <button type="submit" class="px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded">Añadir</button>
    </form>
    <datalist id="tag-options">
      {% for name in tag_names %}
        <option value="{{ name }}"></option>
      {% endfor %}
    </datalist>
    <datalist id="topic-options">
      {% for name in topic_names %}
        <option value="{{ name }}"></option>
      {% endfor %}
    </datalist>
  </section>
</section>
{% endblock %}
